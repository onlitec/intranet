{% extends "base.html" %}

{% block content %}
<div class="mb-6">
    <h1 class="text-2xl font-bold">{{ '‚úèÔ∏è Editar' if server else '‚ûï Novo' }} Servidor</h1>
</div>

<div class="max-w-4xl">
    <form method="POST" class="card">
        <div class="card-body space-y-4">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label>Nome *</label>
                    <input type="text" name="name" value="{{ server.name if server else '' }}" class="input" required
                        placeholder="Ex: Servidor Principal">
                </div>

                <div class="form-group">
                    <label>Tipo de Servidor *</label>
                    <select name="server_type" class="input">
                        <option value="es-servidor" {{ 'selected' if server and server.server_type=='es-servidor'
                            else '' }}>üñ•Ô∏è ES-SERVIDOR</option>
                        <option value="synology" {{ 'selected' if server and server.server_type=='synology' else '' }}>
                            üì¶ Synology</option>
                        <option value="qnap" {{ 'selected' if server and server.server_type=='qnap' else '' }}>üóÑÔ∏è QNAP
                        </option>
                        <option value="truenas" {{ 'selected' if server and server.server_type=='truenas' else '' }}>üíæ
                            TrueNAS</option>
                        <option value="generic" {{ 'selected' if server and server.server_type=='generic' else '' }}>üîå
                            Gen√©rico</option>
                    </select>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label>Protocolo *</label>
                    <select name="protocol" class="input" id="protocol">
                        <option value="smb" {{ 'selected' if server and server.protocol=='smb' else '' }}>SMB/CIFS
                            (Windows)</option>
                        <option value="nfs" {{ 'selected' if server and server.protocol=='nfs' else '' }}>NFS (Linux)
                        </option>
                        <option value="ftp" {{ 'selected' if server and server.protocol=='ftp' else '' }}>FTP</option>
                        <option value="sftp" {{ 'selected' if server and server.protocol=='sftp' else '' }}>SFTP
                        </option>
                        <option value="webdav" {{ 'selected' if server and server.protocol=='webdav' else '' }}>WebDAV
                        </option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Host/IP *</label>
                    <input type="text" name="host" value="{{ server.host if server else '' }}" class="input" required
                        placeholder="192.168.1.100">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="form-group">
                    <label>Porta</label>
                    <input type="number" name="port" value="{{ server.port if server else '' }}" class="input"
                        placeholder="Auto">
                </div>

                <div class="form-group">
                    <label>Usu√°rio</label>
                    <input type="text" name="username" value="{{ server.username if server else '' }}" class="input"
                        placeholder="admin">
                </div>

                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" name="password" class="input"
                        placeholder="{{ '(n√£o alterada)' if server else 'senha123' }}">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label>Caminho Base</label>
                    <input type="text" name="base_path" value="{{ server.base_path if server else '/' }}" class="input"
                        placeholder="/">
                </div>

                <div class="form-group">
                    <label>API Key (opcional)</label>
                    <input type="text" name="api_key" value="{{ server.api_key if server else '' }}" class="input"
                        placeholder="Para ES-SERVIDOR/Synology">
                </div>
            </div>

            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea name="notes" class="input" rows="3">{{ server.notes if server else '' }}</textarea>
            </div>

            {% if server %}
            <div class="form-group">
                <label class="flex items-center gap-2">
                    <input type="checkbox" name="is_active" {{ 'checked' if server.is_active else '' }}>
                    <span>Servidor Ativo</span>
                </label>
            </div>
            {% endif %}
        </div>

        <div class="card-footer flex justify-between">
            <a href="{{ url_for('admin.file_servers') }}" class="btn btn-outline">
                ‚Üê Voltar
            </a>
            <button type="submit" class="btn btn-primary">
                üíæ Salvar
            </button>
        </div>
    </form>
</div>

{% endblock %}